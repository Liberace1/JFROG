import subprocess
import json

# Artifactory configuration
artifactory_url = "https://YOUR-ARTIFACTORY-URL/artifactory/"
username = "YOUR-USERNAME"
password = "YOUR-PASSWORD"

# Construct the curl command as a list of arguments
curl_command = [
    "curl",
    "-u",
    f"{username}:{password}",
    "-k",
    "-X",
    "GET",
    f"{artifactory_url}api/repositories",
]

# Execute the curl command using subprocess
try:
    result = subprocess.run(curl_command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, check=True)
    # Parse the JSON response
    repositories = json.loads(result.stdout.decode())

    # Print each repository on a separate line
    for repo in repositories:
        print("Repository Key:", repo["key"])
        print("Repository Type:", repo["packageType"])
        print("Repository URL:", repo["url"])
        print("-----")
except subprocess.CalledProcessError as e:
    print(f"Error: {e}")
except json.JSONDecodeError as e:
    print(f"Error decoding JSON response: {e}")
